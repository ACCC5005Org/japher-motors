create database japhermotorsdb;

create table customers (
	customerId INT AUTO_INCREMENT PRIMARY KEY,
	customerName VARCHAR(255) NOT NULL,
	phoneNumber VARCHAR(255) NULL,
	email VARCHAR(255) NOT NULL,
	isDeleted bit default 0
);

create table services (
	serviceId INT AUTO_INCREMENT PRIMARY KEY,
	serviceName VARCHAR(255) NOT NULL,
	carType VARCHAR(255) NOT NULL,
	price FLOAT NOT NULL
);

create table inventory (
	sparePartId INT AUTO_INCREMENT PRIMARY KEY,
	sparePartName VARCHAR(255) NOT NULL,
	carType VARCHAR(255) NOT NULL,
	quantity INT NOT NULL,
	price FLOAT NOT NULL
);


create table bookings (
	bookingId INT AUTO_INCREMENT PRIMARY KEY,
	customerId INT,
	datetimeIn DATETIME NOT NULL,
	datetimeOut DATETIME NOT NULL,
	bookingReference VARCHAR(255) NOT NULL,
	FOREIGN KEY (customerId) REFERENCES customers(customerId)
);

create table bookingServices(
	bookingServicesId INT AUTO_INCREMENT PRIMARY KEY,
	bookingId INT,
	serviceId INT, 
	FOREIGN KEY (bookingId) REFERENCES bookings(bookingId),
	FOREIGN KEY (serviceId) REFERENCES services(serviceId)
);

create table bookingSpareParts(
	bookingSparePartId INT AUTO_INCREMENT PRIMARY KEY,
	bookingId INT,
	sparePartId INT,
	usedQuantity INT,
	FOREIGN KEY (bookingId) REFERENCES bookings(bookingId),
	FOREIGN KEY (sparePartId) REFERENCES inventory(sparePartId)
);

create table payments (
	paymentId INT AUTO_INCREMENT PRIMARY KEY,
	bookingId INT,
	isProcessed BIT NOT NULL default 0,
	totalServices FLOAT NOT NULL default 0,
	totalSpareParts FLOAT NOT NULL default 0,
	totalPrice FLOAT NOT NULL default 0,
	FOREIGN KEY (bookingId) REFERENCES bookings(bookingId)
);

insert into customers(customerName, phoneNumber, email, isDeleted) values ('John Smith', '0799345213','john.smith@gmail.com', 0);
insert into customers(customerName, phoneNumber, email, isDeleted) values ('Olivia Jacob', '0792245211', 'olivia.jacob@gmail.com', 0);
insert into customers(customerName, phoneNumber, email, isDeleted) values ('Emily Wilson', '0792332210', 'emily.wilson@gmail.com', 0);
insert into customers(customerName, phoneNumber, email, isDeleted) values ('Jacob Hail', '0784559902', 'jacob.hail@gmail.com', 0);
insert into customers(customerName, phoneNumber, email, isDeleted) values ('Paul Evans', '0745622219', 'paul.evans@gmail.com', 0);


insert into services (serviceName, carType, price) values ('Oil change', 'sedan' , 500 );
insert into services (serviceName, carType, price) values ('Transmission change', 'sport' ,3000);

insert into inventory(sparePartName, carType, quantity, price) values('Oil 1L', 'sedan', 250, 50);
insert into inventory(sparePartName, carType, quantity, price) values('Transmission for Audi A8', 'sport',  12, 1760);
insert into inventory(sparePartName, carType, quantity, price) values('Transmission for Volkswagen golf', 'sport', 20, 1330);

insert into bookings(customerId, datetimeIn, datetimeOut, bookingReference) values (1, now(), now() +1 , 'aa-bb-cc-dd-ee-123');

insert into bookingServices(bookingId, serviceId) values (1,1);
insert into bookingServices(bookingId, serviceId) values (1,2);
